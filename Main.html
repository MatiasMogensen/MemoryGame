<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Minne spill</title>
    <link rel="stylesheet" href="Stylesheet.css">
</head>

<body>

    <div class="container">

        <h1 class="gameName">Minnespill
        </h1>

        <!--No info in game div, it all gets done in the function "Startgame"-->

        <div id="game"></div>

        <button class="reset" onclick="reset()">Restart
        </button>

    </div>

    <!-- 
    This is a menu that will appear before the game starts and when you want to replay the game.
    -->

    <div id="sizeModal" class="modal">
        <div class="modalMeny">
            <h2>Select your game size</h2>
            <button gameSize="2">2x2</button>
            <button gameSize="4">4x4</button>
            <button gameSize="6">6x6</button>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const modal = document.getElementById('sizeModal');
            const buttons = modal.querySelectorAll('button');

            // Show the modal on pageload
            modal.style.display = 'block';

            //Onclick function to select size
            buttons.forEach(button => {
                button.addEventListener('click', () => {
                    const size = button.getAttribute('gameSize');
                    startGame(size);
                    modal.style.display = 'none';
                    //console.log(`Button with board size ${size}x${size} was pressed.`); 
                });
            });
        });

        function startGame(size) {
            const gameBoard = document.getElementById('game');
            gameBoard.innerHTML = ``;

            // Set up the grid based on the selected size
            gameBoard.style.gridTemplateColumns = `repeat(${size}, 1fr)`;
            gameBoard.style.gridTemplateRows = `repeat(${size}, 1fr)`;

            //Array of cards for each 
            //Could make a for loop here to not have to manually insert everything.
            const cardIdentifiers = {
                2: ["1", "1", "2", "2"],
                // Started making a 3x3 but realized that the odd numbers would make it wierd
                4: ["1", "1", "2", "2", "3", "3", "4", "4", "5", "5", "6", "6", "7", "7", "8", "8"],
                6: ["1", "1", "2", "2", "3", "3", "4", "4", "5", "5", "6", "6", "7", "7", "8", "8", "9", "9", "10", "10", "11", "11", "12", "12", "13", "13", "14", "14", "15", "15", "16", "16", "17", "17", "18", "18"]
            }

            var shuffled = cardIdentifiers[size].sort(() => (Math.random() > .5) ? 1 : -1)

            // for loop to create the right amount of cards based on user selection from Modal
            for (var i = 0; i < shuffled.length; i++) {
                var card = document.createElement('div');
                card.classList.add('card');
                card.textContent = shuffled[i];

                //Selected card function.
                card.onclick = function () {
                    //Clicking a card gives it the class identifier "cardSelected"
                    this.classList.add(`cardSelected`)
                    setTimeout(function () {

                        if (document.querySelectorAll(`.cardSelected`).length > 1) {

                            //If first selected card == second selected card are the same, add a "matched" identifier and remove the "cardSelected" identifier
                            if (document.querySelectorAll(`.cardSelected`)[0].innerHTML == document.querySelectorAll(`.cardSelected`)[1].innerHTML) {
                                document.querySelectorAll(`.cardSelected`)[0].classList.add(`matched`)
                                document.querySelectorAll(`.cardSelected`)[1].classList.add(`matched`)

                                document.querySelectorAll(`.cardSelected`)[1].classList.remove(`cardSelected`, `card`)
                                document.querySelectorAll(`.cardSelected`)[0].classList.remove(`cardSelected`, `card`)

                            } else {
                                document.querySelectorAll(`.cardSelected`)[1].classList.remove(`cardSelected`)
                                document.querySelectorAll(`.cardSelected`)[0].classList.remove(`cardSelected`)
                            }

                            if(document.querySelectorAll(`.matched`).length == shuffled.length){
                                alert("You win, choose a new board to play again")
                                reset()
                            }
                        }


                    }, 1000)


                }
                gameBoard.appendChild(card);


                // Began tring to make a toggle for "cardSelected" but remembered that i will ad a function to reset the selected cards back if they dont match
                // document.querySelectorAll(`.card`).forEach(card => {
                //     card.addEventListener(`click`,()=> {
                //         card.classList.toggle(`cardSelected`)})
                // })


            }


        }

        // The reset function just reveals the modal to restart the game when you pick a new board size.
        function reset() {
            const modal = document.getElementById('sizeModal');
            modal.style.display = 'block';
            //console.log(`You clicked the reset button`)
        }

    </script>

</body>



</html>